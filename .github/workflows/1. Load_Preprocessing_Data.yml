name: 1. Load Preprocessing Data

on:
    push:
        branches:
            - main
        paths:
            - 'src/data_pipelines/preprocessing.py'
    workflow_dispatch:

jobs:
  login:
    runs-on: ubuntu-latest
    steps:
        - uses: actions/checkout@v4 
        - uses: actions/setup-python@v5
          with:
            python-version: '3.12'
            cache: 'pip' # caching pip dependencies
        - run: pip install -r requirements.txt
        - name: Login to WandB
          env:
            WANDB_API_KEY: ${{ secrets.WANDB_API_KEY }}
          run: wandb login $WANDB_API_KEY
        - name: Run data_pipeline preprocessind data
          env:
            HUGGINGFACEHUB_API_TOKEN: ${{ secrets.HUGGINGFACEHUB_API_TOKEN }}
          run: python src/data_pipelines/preprocessing.py --IdExecution ${{ github.run_number }}